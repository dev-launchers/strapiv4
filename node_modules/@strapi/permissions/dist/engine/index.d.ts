import { Ability } from '@casl/ability';
import { providerFactory } from '@strapi/utils';
import type { PermissionEngineHooks, HookName } from './hooks';
import * as abilities from './abilities';
import { Permission } from '../domain/permission';
export { abilities };
type Provider = ReturnType<typeof providerFactory>;
type ActionProvider = Provider;
type ConditionProvider = Provider;
export interface Engine {
    hooks: PermissionEngineHooks;
    on(hook: HookName, handler: (...args: unknown[]) => unknown): Engine;
    generateAbility(permissions: Permission[], options?: object): Promise<Ability>;
    createRegisterFunction(can: (permission: abilities.PermissionRule) => unknown, options: Record<string, unknown>): (permission: abilities.PermissionRule) => Promise<unknown>;
}
export interface EngineParams {
    providers: {
        action: ActionProvider;
        condition: ConditionProvider;
    };
    abilityBuilderFactory?(): abilities.CustomAbilityBuilder;
}
declare const newEngine: (params: EngineParams) => Engine;
export { newEngine as new };
